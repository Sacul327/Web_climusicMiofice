<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
<%@ page import="org.springframework.context.ApplicationContext" %>
<%@ page import="org.springframework.context.support.ClassPathXmlApplicationContext" %>
<%@ page import="com.Climusic.Daos.EmpleadoDao"%>
<%@ page import="com.Climusic.Modelos.Empleado" %>
<%@ page import="java.util.List"%>
<%@ page import="org.springframework.jdbc.CannotGetJdbcConnectionException" %>
<%@ page import="org.springframework.dao.DataAccessException" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<link rel="stylesheet"
	href="css/bootstrap.min.css">

<script
	src="js/bootstrap.min.js"
	></script>
<script
	src="js/jquery.min.js"></script>
<script
	src="js/bootstrap.min.js"></script>
	<link href="css/pantalladVentas.css" rel="stylesheet">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body>

 				       <table class="table table-striped " id="tabla">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Telefono</th>
        <th>Deuda</th>
      </tr>
    </thead>
    <tbody>
    <%
    String nombre = request.getParameter("nombre");
	String id = request.getParameter("id");
	
	ApplicationContext app= new ClassPathXmlApplicationContext("Spring.xml");
	EmpleadoDao empleadodao = (EmpleadoDao) app.getBean("EmpleadoDao"); 
if((nombre!=null)||(id!=null)){
if(nombre!=null){
try {
	List<Empleado> emp = empleadodao.buscarXNombre(nombre);
	for (Empleado emp2 : emp) { %>
      <tr>
        <td><%= emp2.getNombre() %></td>
        <td><%= emp2.getApellido() %></td>
        <td><%= emp2.getDocumento() %></td>
      </tr>
 <%
		}
	} catch (CannotGetJdbcConnectionException ex) {
		ex.printStackTrace();
	} catch (DataAccessException e) {
		e.printStackTrace();
	}
	System.out.println("terminado if");
	}
else { 
		if(id!=null){
		System.out.println(id);
		try {
			
		Empleado emp = empleadodao.buscarXId(Integer.parseInt(id));
		 %>
	      <tr>
	        <td><%= emp.getNombre() %></td>
	        <td><%= emp.getApellido() %></td>
	        <td><%= emp.getDocumento() %></td>
	      </tr>
	 <%
		
	} catch (CannotGetJdbcConnectionException ex) {
		ex.printStackTrace();
	} catch (DataAccessException e) {
		e.printStackTrace();
	}
}
}
}else{
	try {
		List<Empleado> emp = empleadodao.buscarTodos();
		for (Empleado emp2 : emp) { %>
	      <tr>
	        <td><%= emp2.getNombre() %></td>
	        <td><%= emp2.getApellido() %></td>
	        <td><%= emp2.getDocumento() %></td>
	      </tr>
	 <%
		}
	} catch (CannotGetJdbcConnectionException ex) {
		ex.printStackTrace();
	} catch (DataAccessException e) {
		e.printStackTrace();
	}
}
	((ClassPathXmlApplicationContext) app).close();

%>


</body>
</html>